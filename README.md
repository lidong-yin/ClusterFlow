<p align="center">
  <img src="assets/ClusterFlow.png" width="80%" />
</p>

> **åŸºäº Streamlit çš„äººè„¸èšç±»ã€å¯è§†åŒ–åˆ†æã€æ ‡æ³¨ä¸è¯„ä¼°ä¸€ç«™å¼å·¥å…·ã€‚**

é›†æˆäº†æ•°æ®åŠ è½½ã€èšç±»ç®—æ³•è¿è¡Œã€ç»“æœåˆ†æã€äººå·¥è¾…åŠ©æ ‡æ³¨ï¼ˆæ‹†åˆ†/åˆå¹¶ï¼‰ä»¥åŠè¯„ä¼°ç­‰å…¨æµç¨‹åŠŸèƒ½ã€‚é€‚åˆå¿«é€ŸéªŒè¯èšç±»æ•ˆæœã€æ¸…æ´—æ•°æ®æˆ–è¿›è¡Œ Case åˆ†æã€‚

ğŸ‘‰ **[æŸ¥çœ‹è¯¦ç»†ç”¨æˆ·æ‰‹å†Œ (User Manual)](ClusterFlow.md)**

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

*   **æ¨¡å—åŒ–æ¶æ„**ï¼šUI ä¸é€»è¾‘åˆ†ç¦»ï¼ŒåŸºäº Streamlit å¤šé¡µé¢åº”ç”¨ (MPA) è®¾è®¡ï¼Œæ˜“äºæ‰©å±•ã€‚
*   **é«˜æ€§èƒ½è®¡ç®—**ï¼šåˆ©ç”¨ **Faiss** (GPU/CPU) åŠ é€Ÿå¤§è§„æ¨¡å‘é‡æ£€ç´¢ä¸ KNN å›¾æ„å»ºã€‚
*   **å¤šç®—æ³•æ”¯æŒ**ï¼šå†…ç½® **HAC** (å±‚æ¬¡èšç±»)ã€**Infomap** (ç¤¾ç¾¤å‘ç°)ã€**KMeans** ç­‰ä¸»æµç®—æ³•ã€‚
*   **äº¤äº’å¼åˆ†æ**ï¼šæ”¯æŒæŒ‰ç°‡å¤§å°ã€æ–¹å·®ï¼ˆçº¯åº¦ï¼‰ã€æ•£åº¦ï¼ˆè·¨ç°‡ç›¸ä¼¼åº¦ï¼‰ç­‰å¤šç»´åº¦æ’åºæŸ¥çœ‹ã€‚
*   **äººå·¥æ ‡æ³¨**ï¼šæä¾›å¯è§†åŒ–çš„â€œæ‹†åˆ†â€ä¸â€œåˆå¹¶â€å·¥å…·ï¼Œç›´æ¥ä¿®æ­£èšç±»ç»“æœå¹¶ä¿å­˜ã€‚
*   **è¯„ä¼°ä½“ç³»**ï¼šé›†æˆ Pairwise F1ã€BCubed F1 ç­‰æ ‡å‡†è¯„ä¼°æŒ‡æ ‡ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

æ¨èä½¿ç”¨ Python 3.10+ ç¯å¢ƒã€‚

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/lidong-yin/ClusterFlow.git
cd ClusterFlow

# 2. å®‰è£…åŸºç¡€ä¾èµ–
pip install -r requirements.txt

# 3. (å¯é€‰ä½†æ¨è) å®‰è£… Faiss ä¸ Infomap ä»¥è·å¾—å®Œæ•´åŠŸèƒ½
# conda install -c conda-forge faiss-gpu  # æˆ– faiss-cpu
# pip install infomap
```

### 2. å¯åŠ¨åº”ç”¨

```bash
streamlit run app.py
```

---

## ğŸ“‚ æ•°æ®è¾“å…¥è¦æ±‚

æ”¯æŒ `pkl`, `pickle`, `parquet`, `csv` æ ¼å¼æ–‡ä»¶ã€‚ç•Œé¢ä¸­éœ€è¾“å…¥**æœåŠ¡å™¨ç«¯ç»å¯¹è·¯å¾„**è¿›è¡ŒåŠ è½½ã€‚

### å¿…éœ€å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
| :--- | :--- | :--- |
| `obj_id` | `str` / `int` | æ ·æœ¬å”¯ä¸€æ ‡è¯† |
| `img_url` | `str` | å›¾ç‰‡è®¿é—®è·¯å¾„ï¼ˆURL æˆ–æœ¬åœ°è·¯å¾„ï¼‰ |
| `gt_person_id` | `str` / `int` | Ground Truth èº«ä»½/ç°‡æ ‡ç­¾ |

### å¯é€‰å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
| :--- | :--- | :--- |
| `feature` | `list` / `ndarray` | äººè„¸ç‰¹å¾å‘é‡ (å¦‚ 512ç»´)ï¼Œç”¨äºèšç±»/åˆ†æ/æ£€ç´¢ |
| `cluster_id*` | `int` | ä»»æ„èšç±»ç»“æœåˆ—ï¼ˆå¦‚ `cluster_id_hac`ï¼‰ |
| `ok` | `bool` | æ ·æœ¬æœ‰æ•ˆæ€§æ ‡è®° (True/False) |

---

## ğŸ“š ç›®å½•ç»“æ„

```text
.
â”œâ”€â”€ app.py                  # å…¥å£æ–‡ä»¶
â”œâ”€â”€ pages/                  # Streamlit é¡µé¢
â”‚   â”œâ”€â”€ 01_Home.py          # æ•°æ®æ¦‚è§ˆ
â”‚   â”œâ”€â”€ 02_Clustering.py    # ç®—æ³•æ‰§è¡Œ
â”‚   â”œâ”€â”€ 03_Analysis.py      # åˆ†æå¯è§†åŒ–
â”‚   â”œâ”€â”€ 04_Annotation.py    # äººå·¥æ ‡æ³¨
â”‚   â””â”€â”€ 05_Evaluation.py    # æŒ‡æ ‡è¯„ä¼°
â”œâ”€â”€ src/                    # æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ clustering_utils.py # èšç±»ç®—æ³•å®ç°
â”‚   â”œâ”€â”€ analysis_utils.py   # åˆ†æé€»è¾‘
â”‚   â”œâ”€â”€ faiss_utils.py      # Faiss å°è£…
â”‚   â””â”€â”€ ...
â””â”€â”€ assets/                 # é™æ€èµ„æº
```

